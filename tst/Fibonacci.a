_MAIN:   read A0 ; Le o numero "n" para calcular o Fibonacci(n).
    call _FIBONACCI
    write A2    ; Imprime o resultado armazenado que foi armazenado em A2 na funcao.
    stop        ; Fim da funcao main, encerrando o programa.
_FIBONACCI:  load_c A2 3
    subtract A0 A2  ; Subtrai 3 do parametro passado para verificar se ele eh maior que 2.
    jmpn A0 DEFAULT ; Caso nao seja maior que 2, retorna o valor default. Eh verificado se ficou negativo para restringir todos os parametros menores ou iguais a 2, inclusive os numeros negativos.
    move A0 A3      ; A0 sera o contador do loop, "i".
    load A1 _one     ; A1 sera o Fibonnaci(n - 2).
    load A2 _one     ; A2 sera o Fibonnaci(n - 1).
    add A3 A1       ; Adiciona 1 ao contador, para fazer comparacao com 0, em vez de comparacao com numero negativo, como foi feito anteriormente.
_LOOP: jmpz A3 FINISH ; Caso o contador tenha chegado em 0, encerra o loop.
    load A0 _one
    subtract A3 A0  ; Subtrai 1 do contador "i".
    load A0 _zero    ; Zera o registrador para armazenar a soma A1 + A2.
    add A0 A1
    add A0 A2
    move A2 A1      ; A1 passa a ser o Fibonnaci(n - i - 1).
    move A0 A2      ; A2 passa a ser o Fibonnaci(n - i), sendo o resultado final quando "i" = 0.
    jump _LOOP       ; Executa o loop novamente.
_DEFAULT:    load A2 _one ; Resultado padrao 1 quando "n" eh menor ou igual a 2.
_FINISH:     return      ; Sai da funcao e retorna ao endereco onde foi chamada. Fibonnaci(n) estara armazenado em A2.
_zero: .data 2 0 ; Inicializa a constante 0.
_one: .data 2 1  ; Inicializa a constante 1.